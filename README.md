## Установка и запуск

### Склонируйте репозиторий:

```bash
git clone https://github.com/Kirill8769/authorization_service.git
```

### Перейдите в папку с проектом

```bash
cd authorization_service
```

### Установите зависимости:

Сначала активируем poetry
```bash
poetry shell
```

Затем установим все зависимости из pyproject.toml
```bash
poetry install
```

Для определения необходимых переменных окружения воспользуйтесь шаблоном
```bash
.env.sample
```

Сделайте миграции
```bash
python manage.py makemigrations
python manage.py migrate
```

Создайте суперпользователя
```bash
python manage.py csu
```

## Запуск программы

### Сервер сайта
Для запуска сервера сайта выполните команду:
```bash
python manage.py runserver
```

## Установка и запуск с использованием Docker

### Внесите изменения в переменные окружения
- POSTGRES_HOST=db

### Соберите образ
```bash
docker-compose build
```

### Запустите собранный образ
```bash
docker-compose up -d
```

## Как работает авторизация
1. Нажмите на кнопку "Авторизоваться".
2. Введите номер телефона в соответствующее поле.
3. Получите смс на указанный номер телефона с кодом верификации.
4. Введите полученный код верификации в соответствующее поле.

## Что можно делать, залогинившись в системе
- Просмотреть свой профиль.
- Ввести реферальный инвайт-код (можно сделать только один раз).

## Как использовать сервис по API

### Получить список пользователей

**GET** запрос на `http://127.0.0.1:8000/users/api_list/`

### Авторизоваться в системе

#### Шаг 1. Передайте номер телефона.  
**POST** запрос на `http://127.0.0.1:8000/users/api_authorization/`  
В body передайте JSON:
```json
{
 "phone": "Ваш номер телефона"
}
```

#### Шаг 2. Верифицируйте номер телефона.  
**POST** запрос на `http://127.0.0.1:8000/users/api_verification/`  
В body передайте JSON:
```json
{
 "phone": "Ваш номер телефона",
 "code": "4-х значный код верификации"
}
```

#### Результат. При успешной верификации Вы получите токен авторизации.

### Посмотреть профиль пользователя

**GET** запрос на `http://127.0.0.1:8000/users/api_detail/<int:pk>/`  
В header передайте в ключ Authorization сгенерированный токен в формате Bearer Token

### Активировать инвайт-код

**PUT** или **PATCH** запрос на `http://127.0.0.1:8000/users/api_update/<int:pk>/`  
В header передайте: 
```json
{
 "Authorization": "Сгенерированный токен в формате Bearer Token"
}
  ```
В body передайте JSON:
```json
{
 "another_invite_code": "Инвайт-код другого пользователя"
}
```

## Лицензия

Проект распространяется под лицензией MIT.

---

Этот README файл предоставляет основную информацию о проекте, его установке и использовании.